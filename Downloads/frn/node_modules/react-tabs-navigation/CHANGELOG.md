bug: did not scale correctly in some wierd cases
